<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Starlight TV - Ao Vivo</title>
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/705/705062.png">
    
    <!-- Bibliotecas Externas -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <!-- Importando o CSS separado -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="flex flex-col items-center justify-center">

    <!-- BACKGROUND ANIMADO -->
    <div class="ambient-bg"></div>
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
    <div class="blob blob-3"></div>

    <!-- CUSTOM ALERT/CONFIRM DIALOG -->
    <div id="custom-dialog" class="fixed inset-0 z-[200] flex items-center justify-center bg-black/80 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-300">
        <div class="glass-panel p-8 rounded-3xl max-w-sm w-full mx-6 transform scale-95 transition-transform duration-300 flex flex-col items-center text-center shadow-2xl border border-white/10" id="custom-dialog-content">
            
            <div id="dialog-icon-container" class="dialog-icon bg-white/5 mb-4">
                <i id="dialog-icon" data-lucide="info" class="w-6 h-6 text-white"></i>
            </div>

            <h3 id="custom-dialog-title" class="text-xl font-bold text-white mb-2 font-[Outfit]">T√≠tulo</h3>
            <p id="custom-dialog-message" class="text-zinc-300 text-sm mb-6 leading-relaxed">Mensagem do sistema.</p>
            
            <div class="flex gap-3 w-full justify-center" id="custom-dialog-actions">
                <!-- Bot√µes injetados via JS -->
            </div>
        </div>
    </div>

    <!-- CONTEXT MENU (Mobile) -->
    <div id="context-menu">
        <button id="context-delete-btn" class="context-btn">
            <i data-lucide="trash-2" class="w-5 h-5"></i> Excluir Mensagem
        </button>
        <div class="text-[10px] text-center text-zinc-500 mt-2 pb-1">Toque fora para cancelar</div>
    </div>
    <!-- Overlay transparente para fechar o menu -->
    <div id="context-overlay" class="fixed inset-0 z-[190] hidden" onclick="closeContextMenu()"></div>

    <!-- MODAL DE CONFIGURA√á√ïES -->
    <div id="settings-modal" class="modal-overlay fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm">
        <div class="modal-content glass-modal w-full max-w-md rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[85vh]">
            
            <!-- Modal Header -->
            <div class="p-6 border-b border-white/5 flex justify-between items-center bg-white/5">
                <h2 class="text-xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="settings" class="w-5 h-5 opacity-70"></i> Configura√ß√µes
                </h2>
                <button onclick="closeSettings()" class="w-8 h-8 rounded-full bg-white/5 hover:bg-white/10 flex items-center justify-center transition">
                    <i data-lucide="x" class="w-4 h-4"></i>
                </button>
            </div>

            <!-- Modal Tabs -->
            <div class="flex p-4 gap-2 border-b border-white/5">
                <button onclick="switchSettingsTab('profile')" id="btn-tab-profile" class="flex-1 py-2 rounded-lg text-sm font-bold transition bg-white/10 text-white">
                    Perfil
                </button>
                <button onclick="switchSettingsTab('themes')" id="btn-tab-themes" class="flex-1 py-2 rounded-lg text-sm font-bold transition text-zinc-400 hover:bg-white/5">
                    Prefer√™ncias
                </button>
            </div>

            <!-- Modal Body (Scrollable) -->
            <div class="flex-1 overflow-y-auto custom-scroll p-6 relative">
                
                <!-- Tab: Perfil -->
                <div id="settings-profile" class="space-y-6">
                    <div class="flex flex-col items-center">
                        <div class="relative w-24 h-24 mb-4 group">
                            <img id="settings-avatar-preview" src="https://cdn-icons-png.flaticon.com/128/705/705062.png" class="w-full h-full rounded-full object-cover border-4 border-white/10 shadow-xl bg-black/20" alt="Avatar">
                            <div class="absolute bottom-0 right-0 bg-[var(--primary-color)] p-1.5 rounded-full border border-white/20 shadow-lg">
                                <i data-lucide="check" class="w-3 h-3 text-white"></i>
                            </div>
                        </div>
                        <p id="settings-current-email" class="text-xs text-zinc-500 font-mono">user@email.com</p>
                    </div>

                    <div class="space-y-3">
                        <label class="text-xs uppercase font-bold text-zinc-500 tracking-wider">Nome de Usu√°rio</label>
                        <input id="edit-username" type="text" class="glass-input w-full p-3 rounded-xl text-sm font-bold" placeholder="@username">
                    </div>

                    <div class="space-y-3">
                        <label class="text-xs uppercase font-bold text-zinc-500 tracking-wider">Foto de Perfil</label>
                        <input id="edit-avatar-url" type="hidden"> 
                        
                        <!-- Custom Upload Area -->
                        <div class="upload-area group">
                            <input type="file" id="file-upload-input" accept="image/*" onchange="handleFileUpload(this)">
                            <div class="flex flex-col items-center gap-2 pointer-events-none group-hover:scale-105 transition-transform">
                                <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center text-zinc-300 group-hover:bg-[var(--primary-color)] group-hover:text-white transition-colors">
                                    <i data-lucide="camera" class="w-5 h-5"></i>
                                </div>
                                <span class="text-sm font-bold text-zinc-300">Carregar Imagem</span>
                                <span class="text-[10px] text-zinc-500">JPG, PNG, GIF (Max 5MB)</span>
                            </div>
                        </div>
                        <p id="upload-status" class="text-[10px] text-center text-[var(--primary-color)] hidden animate-pulse mt-2">Enviando para o Imgur...</p>
                        
                        <div class="relative pt-2">
                            <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-white/10"></div></div>
                            <div class="relative flex justify-center text-[10px] uppercase"><span class="bg-[#15151a] px-2 text-zinc-500">ou use URL</span></div>
                        </div>

                         <div class="flex gap-2">
                             <input id="custom-avatar-input" type="text" class="glass-input w-full p-3 rounded-xl text-xs text-zinc-300" placeholder="https://..." onchange="document.getElementById('edit-avatar-url').value = this.value; window.updateAvatarPreview(this.value)">
                        </div>
                    </div>

                    <button onclick="saveProfileChanges()" class="w-full py-3 bg-[var(--primary-color)] text-white font-bold rounded-xl hover:opacity-90 transition shadow-lg mt-4">
                        SALVAR ALTERA√á√ïES
                    </button>

                    <div class="pt-6 border-t border-white/5 mt-6">
                        <button onclick="performLogout()" class="w-full py-3 bg-red-500/10 border border-red-500/20 text-red-400 font-bold rounded-xl hover:bg-red-500/20 transition flex items-center justify-center gap-2">
                            <i data-lucide="log-out" class="w-4 h-4"></i> SAIR DA CONTA
                        </button>
                    </div>
                </div>

                <!-- Tab: Temas & Prefer√™ncias -->
                <div id="settings-themes" class="space-y-4 hidden">
                    <div class="mb-6">
                        <label class="flex items-center justify-between p-3 bg-white/5 rounded-xl border border-white/5 cursor-pointer hover:bg-white/10 transition">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-full bg-violet-500/20 flex items-center justify-center text-violet-400"><i data-lucide="type" class="w-4 h-4"></i></div>
                                <div>
                                    <div class="text-sm font-bold text-white">Letreiro Autom√°tico</div>
                                    <div class="text-[10px] text-zinc-500">Mostrar alertas de pr√≥ximo programa</div>
                                </div>
                            </div>
                            <input type="checkbox" id="pref-ticker" class="w-4 h-4 accent-[var(--primary-color)]" checked onchange="toggleLocalTicker(this.checked)">
                        </label>
                    </div>

                    <p class="text-sm text-zinc-400 mb-4">Escolha a atmosfera da sua interface:</p>
                    
                    <div class="grid grid-cols-1 gap-3">
                        <div onclick="setTheme('default')" class="theme-option active bg-gradient-to-r from-violet-900 to-indigo-900 flex items-center px-4" data-theme-id="default">
                            <div class="w-3 h-3 rounded-full bg-violet-500 mr-3"></div> <span class="text-sm font-bold">Starlight (Padr√£o)</span>
                        </div>
                        <div onclick="setTheme('ocean')" class="theme-option bg-gradient-to-r from-sky-900 to-cyan-900 flex items-center px-4" data-theme-id="ocean">
                            <div class="w-3 h-3 rounded-full bg-cyan-400 mr-3"></div> <span class="text-sm font-bold">Oceanic Deep</span>
                        </div>
                        <div onclick="setTheme('sunset')" class="theme-option bg-gradient-to-r from-rose-900 to-orange-900 flex items-center px-4" data-theme-id="sunset">
                            <div class="w-3 h-3 rounded-full bg-orange-500 mr-3"></div> <span class="text-sm font-bold">Sunset Vibes</span>
                        </div>
                        <div onclick="setTheme('matrix')" class="theme-option bg-gradient-to-r from-green-900 to-emerald-900 flex items-center px-4" data-theme-id="matrix">
                            <div class="w-3 h-3 rounded-full bg-green-500 mr-3"></div> <span class="text-sm font-bold">Matrix Code</span>
                        </div>
                        <div onclick="setTheme('royal')" class="theme-option bg-gradient-to-r from-yellow-900 to-amber-900 flex items-center px-4" data-theme-id="royal">
                            <div class="w-3 h-3 rounded-full bg-amber-500 mr-3"></div> <span class="text-sm font-bold">Royal Gold</span>
                        </div>
                         <div onclick="setTheme('mono')" class="theme-option bg-gradient-to-r from-zinc-800 to-zinc-900 flex items-center px-4" data-theme-id="mono">
                            <div class="w-3 h-3 rounded-full bg-white mr-3"></div> <span class="text-sm font-bold">Monochrome</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- MODAL DE DETALHES DA PROGRAMA√á√ÉO -->
    <div id="program-modal" class="modal-overlay fixed inset-0 z-[140] flex items-center justify-center p-6 bg-black/80 backdrop-blur-md">
        <div class="modal-content glass-modal w-full max-w-lg rounded-3xl overflow-hidden shadow-2xl relative">
            <button onclick="closeProgramModal()" class="absolute top-4 right-4 z-10 w-8 h-8 rounded-full bg-black/50 text-white flex items-center justify-center hover:bg-white/20 transition">
                <i data-lucide="x" class="w-5 h-5"></i>
            </button>
            
            <div class="h-48 bg-black relative">
                <img id="modal-img" src="" class="w-full h-full object-cover opacity-80" alt="Program Cover">
                <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent"></div>
                <div class="absolute bottom-4 left-6">
                    <span id="modal-category" class="px-2 py-1 bg-[var(--primary-color)] text-white text-[10px] font-bold uppercase rounded mb-2 inline-block">Categoria</span>
                    <h2 id="modal-title" class="text-2xl font-bold text-white leading-tight font-[Outfit]">Titulo do Programa</h2>
                </div>
            </div>

            <div class="p-6">
                <div class="flex items-center gap-4 text-sm text-zinc-400 mb-4 font-mono">
                    <div class="flex items-center gap-1"><i data-lucide="clock" class="w-4 h-4"></i> <span id="modal-time">00:00</span></div>
                    <div class="flex items-center gap-1"><i data-lucide="hourglass" class="w-4 h-4"></i> <span id="modal-duration">00 min</span></div>
                </div>
                <p id="modal-desc" class="text-zinc-300 text-sm leading-relaxed mb-6">Descri√ß√£o detalhada do programa...</p>
                
                <button onclick="closeProgramModal()" class="w-full py-3 bg-white/5 border border-white/10 text-white font-bold rounded-xl hover:bg-white/10 transition">
                    FECHAR
                </button>
            </div>
        </div>
    </div>

    <!-- MANUTEN√á√ÉO -->
    <div id="maintenance-screen" class="fixed inset-0 z-[120] bg-black/90 backdrop-blur-xl flex flex-col items-center justify-center hidden">
        <div class="p-8 rounded-3xl bg-white/5 border border-white/10 text-center fade-in-up">
            <img src="https://cdn-icons-png.flaticon.com/128/705/705062.png" class="w-20 h-20 mx-auto mb-6 object-contain animate-pulse opacity-80" alt="Manuten√ß√£o">
            <h1 class="text-3xl font-bold text-white mb-2 tracking-tight">Sistema Offline</h1>
            <p id="maintenance-message" class="text-zinc-400 font-mono text-sm">Realizando ajustes nos transmissores.</p>
        </div>
    </div>

    <!-- TELA DE LOGIN (MODAL DE VIDRO) -->
    <div id="login-screen" class="fixed inset-0 z-[100] flex flex-col items-center justify-center p-4 transition-all duration-700 bg-black/80">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-md"></div>
        
        <div class="relative w-full max-w-md glass-panel rounded-3xl p-8 md:p-10 scale-in shadow-2xl z-10">
            <div class="text-center mb-8">
                <div class="flex justify-center mb-6">
                    <img src="https://cdn-icons-png.flaticon.com/128/705/705062.png" class="w-32 h-32 object-contain drop-shadow-[0_0_30px_rgba(139,92,246,0.5)] hover:scale-110 transition-transform duration-500" alt="Logo">
                </div>
                <h1 class="text-5xl font-bold text-white tracking-tight mb-1 font-[Outfit]">STARLIGHT TV</h1>
                <p class="text-zinc-400 text-sm font-medium">Acesse sua frequ√™ncia exclusiva</p>
            </div>

            <div class="space-y-4">
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <i data-lucide="mail" class="w-5 h-5 text-zinc-500 group-focus-within:text-[var(--primary-color)] transition-colors"></i>
                    </div>
                    <input type="email" id="login-email" class="glass-input w-full pl-12 pr-4 py-4 rounded-xl text-sm placeholder-zinc-500" placeholder="seu@email.com">
                </div>
                
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <i data-lucide="lock" class="w-5 h-5 text-zinc-500 group-focus-within:text-[var(--primary-color)] transition-colors"></i>
                    </div>
                    <input type="password" id="login-password" class="glass-input w-full pl-12 pr-4 py-4 rounded-xl text-sm placeholder-zinc-500" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <button id="btn-do-login" class="w-full py-4 bg-white text-black font-bold rounded-xl active:scale-95 hover:scale-[1.02] transition shadow-[0_0_20px_rgba(255,255,255,0.2)] mt-2 touch-manipulation">
                    CONECTAR
                </button>
                
                <div class="relative py-2">
                    <div class="absolute inset-0 flex items-center"><div class="w-full border-t border-white/10"></div></div>
                    <div class="relative flex justify-center text-xs uppercase"><span class="bg-[#15151a] px-2 text-zinc-500">ou</span></div>
                </div>

                <button id="btn-do-signup" class="w-full py-4 bg-white/5 border border-white/10 text-white font-semibold rounded-xl hover:bg-white/10 active:bg-white/20 transition touch-manipulation">
                    CRIAR NOVA CONTA
                </button>
            </div>
            <p id="login-error" class="text-red-400 bg-red-500/10 border border-red-500/20 p-3 rounded-lg text-xs mt-6 text-center hidden flex items-center justify-center gap-2">
                <i data-lucide="alert-circle" class="w-4 h-4"></i> <span>Erro ao autenticar</span>
            </p>
        </div>
    </div>

    <!-- TELA DE USERNAME -->
    <div id="username-screen" class="fixed inset-0 z-[110] bg-black/80 backdrop-blur-xl flex flex-col items-center justify-center hidden">
        <div class="w-full max-w-sm glass-panel p-8 rounded-3xl text-center scale-in">
            <div class="w-14 h-14 bg-violet-500/20 rounded-full flex items-center justify-center mx-auto mb-4 text-violet-400">
                <i data-lucide="user" class="w-7 h-7"></i>
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">Identifica√ß√£o</h2>
            <p class="text-zinc-400 text-sm mb-6">Como voc√™ ser√° conhecido no chat?</p>
            
            <input type="text" id="username-input" class="glass-input w-full text-center text-xl font-bold tracking-wide py-4 rounded-xl mb-4" placeholder="@usuario" autocomplete="off">
            
            <button id="btn-save-username" class="w-full py-3 bg-[var(--primary-color)] text-white font-bold rounded-xl hover:opacity-90 transition shadow-lg">
                CONFIRMAR ID
            </button>
            <p id="username-error" class="text-red-400 text-xs mt-4 hidden"></p>
        </div>
    </div>

    <!-- APP CONTAINER PRINCIPAL -->
    <div id="app-container" class="w-full h-full md:max-w-[1700px] md:h-[92vh] flex flex-col md:flex-row overflow-hidden relative z-10 opacity-0 transition-opacity duration-1000 md:gap-6 md:p-6">
        
        <!-- √ÅREA DO VIDEO (PLAYER) -->
        <main class="w-full md:flex-[3] flex flex-col relative shrink-0 h-[35vh] md:h-auto md:rounded-[32px] overflow-hidden video-wrapper-glass bg-black md:bg-black/40">
            
            <!-- LIVE VIEWERS COUNT (Floating Top Left) -->
            <div id="viewer-count" class="viewer-count">
                 <div class="live-dot animate-pulse"></div>
                 <span id="viewer-number">0</span> Assistindo
            </div>

            <!-- Header Flutuante (Desktop) -->
            <div class="absolute top-0 left-0 right-0 p-6 z-[60] hidden md:flex justify-between items-start pointer-events-none">
                 <!-- SPACER to push content right -->
                 <div></div>

                <div class="flex items-center gap-3 pointer-events-auto">
                    <div id="live-indicator" class="hidden px-3 py-1.5 bg-red-500/20 border border-red-500/30 text-red-400 rounded-full text-[10px] font-bold tracking-wider flex items-center gap-2 backdrop-blur-sm shadow-lg">
                        <span class="relative flex h-2 w-2">
                          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                          <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
                        </span>
                        AO VIVO
                    </div>
                    <div class="font-mono text-zinc-300 text-xs bg-black/30 backdrop-blur-md px-3 py-1.5 rounded-full border border-white/5 shadow-lg" id="clock">00:00</div>
                    
                    <!-- BOT√ÉO DE CONFIGURA√á√ïES (Settings) -->
                    <button onclick="openSettings()" class="p-2 bg-white/5 hover:bg-white/20 text-white/70 hover:text-white rounded-full transition backdrop-blur-sm shadow-lg border border-white/5 relative z-50 pointer-events-auto" title="Configura√ß√µes & Perfil">
                        <i data-lucide="settings" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>

            <!-- Video Player Wrapper -->
            <div id="video-wrapper" class="relative w-full h-full bg-black group">
                <video id="main-video" class="absolute inset-0 w-full h-full object-cover transition-all duration-500" playsinline></video>
                
                <!-- NEW: FLOATING TICKER (Letreiro) -->
                <div id="ticker-float" class="ticker-float">
                    <div class="ticker-badge" id="ticker-badge">A SEGUIR</div>
                    <div class="ticker-text" id="ticker-text">Carregando programa√ß√£o...</div>
                </div>

                <!-- Watermark -->
                <img src="https://cdn-icons-png.flaticon.com/128/705/705062.png" class="absolute bottom-16 right-6 w-10 h-10 opacity-20 z-10 pointer-events-none mix-blend-screen" alt="Watermark">

                <!-- Standby Screen -->
                <div id="standby-screen" class="absolute inset-0 bg-[#050505] flex flex-col items-center justify-center z-10">
                    <div class="relative w-32 h-32 mb-6 flex items-center justify-center">
                        <div class="absolute inset-0 border-2 border-[var(--primary-color)] opacity-30 rounded-full animate-[ping_3s_linear_infinite]"></div>
                        <div class="absolute inset-4 border border-[var(--primary-color)] opacity-50 rounded-full"></div>
                        <img src="https://cdn-icons-png.flaticon.com/128/705/705062.png" class="w-16 h-16 object-contain relative z-10 drop-shadow-[0_0_15px_var(--text-glow)]" alt="Standby">
                    </div>
                    <h2 class="text-xl font-bold text-white mb-2 tracking-wide font-[Outfit]">AGUARDANDO SINAL</h2>
                    <p class="text-zinc-600 text-sm font-mono tracking-widest uppercase">Transmiss√£o em breve</p>
                </div>

                <!-- Sync Overlay -->
                <div id="sync-status" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black/60 backdrop-blur-xl px-6 py-3 rounded-2xl text-sm font-bold text-emerald-400 hidden border border-emerald-500/30 z-40 flex items-center gap-3 shadow-2xl">
                    <i data-lucide="refresh-cw" class="w-4 h-4 animate-spin"></i> Sincronizando Feed...
                </div>

                <!-- Controls Overlay (JS-Toggled) -->
                <div id="video-controls" class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-0 transition-opacity duration-500 flex flex-col justify-end p-6 md:p-10 z-30 pointer-events-none">
                    
                    <!-- Info do Programa -->
                    <div class="mb-6 transform translate-y-4 transition-transform duration-500" id="program-info">
                        <div class="inline-flex items-center gap-2 px-2 py-1 bg-white/10 border border-white/10 rounded text-[10px] font-bold text-[var(--primary-color)] uppercase tracking-widest mb-2" id="program-category">OFF AIR</div>
                        <h2 id="program-title" class="text-2xl md:text-4xl font-bold text-white drop-shadow-2xl leading-none font-[Outfit] tracking-tight mb-2">...</h2>
                        <p id="program-desc" class="text-zinc-300 text-xs md:text-sm max-w-2xl line-clamp-2 md:line-clamp-none opacity-80">...</p>
                    </div>

                    <!-- Barra de Controles -->
                    <div class="flex items-center gap-4 md:gap-6 bg-white/5 backdrop-blur-md p-3 rounded-2xl border border-white/5 shadow-xl pointer-events-auto">
                        <button onclick="window.toggleMute()" class="control-btn-modern">
                            <i id="mute-icon" data-lucide="volume-x" class="w-5 h-5"></i>
                        </button>
                        
                        <!-- Barra de Progresso Liquid -->
                        <div class="flex-1 h-2 bg-white/10 rounded-full overflow-hidden backdrop-blur-sm">
                            <div id="progress-bar" class="h-full bg-gradient-to-r from-[var(--primary-color)] to-[var(--secondary-color)] w-0 relative shadow-[0_0_10px_var(--text-glow)] transition-all duration-1000 ease-linear"></div>
                        </div>
                        
                        <button onclick="window.toggleZoom()" class="control-btn-modern text-zinc-300" title="Ajustar Zoom">
                            <i id="zoom-icon" data-lucide="rectangle-horizontal" class="w-5 h-5"></i>
                        </button>

                        <button onclick="window.toggleFullscreen()" class="control-btn-modern text-zinc-300">
                            <i id="fullscreen-icon" data-lucide="maximize" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Sidebar (Schedule & Chat) -->
        <aside class="w-full md:flex-1 md:max-w-[400px] flex flex-col glass-panel md:rounded-[32px] h-[65vh] md:h-auto relative overflow-hidden transition-all">
            
            <!-- Tabs Flutuantes -->
            <div class="p-4 md:p-6 shrink-0 z-20 bg-gradient-to-b from-[rgba(20,20,25,0.9)] to-transparent">
                <div class="flex p-1 bg-black/40 rounded-xl border border-white/5">
                    <button onclick="switchSidebarTab('chat')" id="tab-chat" class="flex-1 py-2.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all text-zinc-400 hover:text-white flex items-center justify-center gap-2 bg-white/10 text-white shadow-lg">
                        <i data-lucide="message-circle" class="w-4 h-4"></i> Chat
                    </button>
                    <button onclick="switchSidebarTab('grade')" id="tab-grade" class="flex-1 py-2.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all text-zinc-400 hover:text-white flex items-center justify-center gap-2">
                        <i data-lucide="calendar-days" class="w-4 h-4"></i> Grade
                    </button>
                </div>
            </div>
            
            <!-- Conte√∫do: CHAT -->
            <div id="content-chat" class="flex-1 flex flex-col min-h-0 relative">
                
                <!-- NEW: POLL WIDGET -->
                <div id="poll-widget" class="poll-widget mx-4">
                    <h3 class="text-xs font-bold text-white mb-2" id="poll-question">...</h3>
                    <div id="poll-options"></div>
                </div>

                <div id="chat-messages" class="flex-1 overflow-y-auto px-4 md:px-6 space-y-4 custom-scroll pb-4 scroll-smooth">
                    <!-- Mensagens entram aqui -->
                    <div class="text-center py-10 opacity-50 flex flex-col items-center">
                        <div class="w-12 h-12 bg-white/5 rounded-full flex items-center justify-center mb-3">
                            <i data-lucide="sparkles" class="w-6 h-6 text-[var(--primary-color)]"></i>
                        </div>
                        <p class="text-xs text-zinc-400">Bem-vindo √† transmiss√£o.</p>
                    </div>
                </div>

                <!-- NEW: REACTIONS CONTAINER -->
                <div id="reactions-container" class="reactions-container">
                    <div class="reaction-count-badge" id="reaction-total-count">0 rea√ß√µes</div>
                    <button class="reaction-btn" onclick="sendReaction('‚ù§Ô∏è')">‚ù§Ô∏è</button>
                    <button class="reaction-btn" onclick="sendReaction('üî•')">üî•</button>
                    <button class="reaction-btn" onclick="sendReaction('üòÇ')">üòÇ</button>
                    <button class="reaction-btn" onclick="sendReaction('üëè')">üëè</button>
                </div>

                <!-- GIF PICKER UI -->
                <div id="gif-picker" class="gif-picker-container">
                    <div class="p-2 border-b border-white/10 flex gap-2">
                         <div class="relative flex-1">
                             <input type="text" id="gif-search" class="w-full bg-white/5 rounded-lg px-3 py-1.5 text-xs text-white placeholder-zinc-500 focus:outline-none focus:bg-white/10" placeholder="Buscar no GIPHY..." onkeypress="if(event.key === 'Enter') searchGiphy(this.value)">
                             <button onclick="searchGiphy(document.getElementById('gif-search').value)" class="absolute right-1 top-1 bottom-1 text-zinc-400 hover:text-white">
                                 <i data-lucide="search" class="w-3 h-3"></i>
                             </button>
                         </div>
                         <button onclick="toggleGifPicker()" class="text-zinc-500 hover:text-white"><i data-lucide="x" class="w-4 h-4"></i></button>
                    </div>
                    <!-- GRID 3 COLUNAS para corrigir o empilhamento -->
                    <div id="gif-results" class="grid grid-cols-3 gap-1 p-2 overflow-y-auto flex-1 custom-scroll">
                        <div class="col-span-3 text-center text-xs text-zinc-500 py-4">Carregando GIFs...</div>
                    </div>
                      <div class="p-1 text-[9px] text-center text-zinc-600 bg-black/50">Powered by GIPHY</div>
                </div>
                
                <!-- Input Area Flutuante -->
                <div class="p-4 md:p-6 shrink-0 w-full z-20">
                    <!-- Reply Bar -->
                    <div id="reply-bar" class="reply-bar rounded-t-xl">
                        <span id="reply-text">Respondendo a <strong>@usuario</strong></span>
                        <button onclick="cancelReply()" class="text-zinc-500 hover:text-white"><i data-lucide="x" class="w-3 h-3"></i></button>
                    </div>
                    
                    <form onsubmit="sendMessage(event)" class="relative group flex gap-2">
                        <div class="relative flex-1">
                            <!-- Bot√£o movido para a Esquerda -->
                            <button type="button" onclick="toggleGifPicker()" class="absolute left-2 top-1/2 -translate-y-1/2 p-1.5 text-zinc-400 hover:text-white hover:bg-white/10 rounded-lg transition z-10" title="Enviar GIF">
                                <span class="font-bold text-xs border border-current rounded px-1">GIF</span>
                            </button>
                            <!-- Padding ajustado (pl-14) -->
                            <input id="chat-input" type="text" class="w-full bg-white/5 border border-white/10 rounded-2xl pl-14 pr-4 py-4 text-sm text-white focus:outline-none focus:bg-white/10 focus:border-[var(--primary-color)] transition-all placeholder-zinc-600 shadow-lg backdrop-blur-md" placeholder="Digite sua mensagem..." autocomplete="off">
                        </div>
                        <button type="submit" class="w-12 bg-[var(--primary-color)] hover:opacity-80 text-white rounded-2xl flex items-center justify-center transition-all shadow-lg scale-90 hover:scale-100 shrink-0">
                            <i data-lucide="send-horizontal" class="w-5 h-5 ml-0.5"></i>
                        </button>
                    </form>
                </div>
            </div>

            <!-- Conte√∫do: GRADE -->
            <div id="content-grade" class="flex-1 overflow-y-auto px-4 md:px-6 space-y-3 custom-scroll hidden pb-6">
                <div class="sticky top-0 z-10 bg-gradient-to-b from-[rgba(20,20,25,1)] to-transparent pb-4 pt-2 text-center">
                    <span id="schedule-day-label" class="text-[10px] font-bold text-[var(--primary-color)] uppercase tracking-[0.2em] border border-white/10 px-3 py-1 rounded-full bg-white/5">Carregando...</span>
                </div>
                <div id="schedule-list" class="space-y-3"></div>
                
                <!-- MOBILE SETTINGS BUTTON -->
                <div class="mt-8 p-6 rounded-2xl bg-white/5 border border-dashed border-white/10 text-center relative group">
                    <p class="text-[10px] text-zinc-600 uppercase tracking-widest mb-2">Starlight Broadcast System v2.1</p>
                    <button onclick="openSettings()" class="md:hidden w-full py-2 bg-white/5 border border-white/10 rounded-lg text-xs font-bold text-zinc-400 flex items-center justify-center gap-2 hover:bg-white/10 hover:text-white transition">
                        <i data-lucide="settings" class="w-3 h-3"></i> Configura√ß√µes
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- Importando o JS separado -->
    <script type="module" src="script.js"></script>
</body>
</html>